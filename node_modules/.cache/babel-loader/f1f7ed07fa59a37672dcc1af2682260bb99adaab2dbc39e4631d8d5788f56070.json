{"ast":null,"code":"import{createSlice}from\"@reduxjs/toolkit\";import{getAllProductsThunk}from\"../../redux-thunk/products-thunk/getAllProductsThunk\";import{isError}from\"../../../utils/utilStore\";import{isLiked}from\"../../../utils/products\";import{changeLikeProductThunk}from\"../../redux-thunk/products-thunk/changeLikeProductThunk\";import{SORTED}from\"../../../utils/constants\";var initialState={products:[],favourites:[],currentSort:'',total:0,isLoading:false,error:null};var productsSlice=createSlice({name:'products',initialState:initialState,reducers:{sortedProductsState:function sortedProductsState(state,action){switch(action.payload){case SORTED.LOW:state.products=state.products.sort(function(a,b){return b.price-a.price;});state.currentSort=action.payload;break;case SORTED.CHEAP:state.products=state.products.sort(function(a,b){return a.price-b.price;});state.currentSort=action.payload;break;case SORTED.SALE:state.products=state.products.sort(function(a,b){return b.discount-a.discount;});state.currentSort=action.payload;break;default:state.products=state.products.sort(function(a,b){return b.likes.length-a.likes.length;});state.currentSort=SORTED.POPULAR;}}},extraReducers:function extraReducers(builder){builder.addCase(getAllProductsThunk.fulfilled,function(state,action){var _action$payload=action.payload,total=_action$payload.total,products=_action$payload.products,currentUser=_action$payload.currentUser;state.products=products;state.favourites=products.filter(function(item){return isLiked(item.likes,currentUser._id);});state.total=total;state.isLoading=false;});builder.addCase(getAllProductsThunk.pending,function(state){state.error=null;state.isLoading=true;});builder.addCase(changeLikeProductThunk.fulfilled,function(state,action){var _action$payload2=action.payload,product=_action$payload2.product,liked=_action$payload2.liked;state.products=state.products.map(function(cardState){return cardState._id===product._id?product:cardState;});if(!liked){state.favourites.push(product);}else{state.favourites=state.favourites.filter(function(card){return card._id!==product._id;});}});builder.addCase(changeLikeProductThunk.pending,function(state){state.error=null;state.isLoading=true;});builder.addMatcher(isError,function(state,action){state.error=action.payload;state.isLoading=false;});}});var sortedProductsState=productsSlice.actions.sortedProductsState;export{sortedProductsState};export default productsSlice.reducer;","map":{"version":3,"names":["createSlice","getAllProductsThunk","isError","isLiked","changeLikeProductThunk","SORTED","initialState","products","favourites","currentSort","total","isLoading","error","productsSlice","name","reducers","sortedProductsState","state","action","payload","LOW","sort","a","b","price","CHEAP","SALE","discount","likes","length","POPULAR","extraReducers","builder","addCase","fulfilled","currentUser","filter","item","_id","pending","product","liked","map","cardState","push","card","addMatcher","actions","reducer"],"sources":["C:/Users/User/Desktop/K.V/Education/SberUniversity/dogfood2/src/redux/redux-slice/products/productsSlice.js"],"sourcesContent":["import {createSlice} from \"@reduxjs/toolkit\";\nimport {getAllProductsThunk} from \"../../redux-thunk/products-thunk/getAllProductsThunk\";\nimport {isError} from \"../../../utils/utilStore\";\nimport {isLiked} from \"../../../utils/products\";\nimport {changeLikeProductThunk} from \"../../redux-thunk/products-thunk/changeLikeProductThunk\";\nimport {SORTED} from \"../../../utils/constants\";\n\nconst initialState = {\n    products: [],\n    favourites: [],\n    currentSort: '',\n    total: 0,\n    isLoading: false,\n    error: null\n}\nconst productsSlice = createSlice({\n    name: 'products',\n    initialState,\n    reducers: {\n        sortedProductsState: (state, action) => {\n            switch (action.payload) {\n                case SORTED.LOW:\n                    state.products = state.products.sort((a, b) => b.price - a.price);\n                    state.currentSort = action.payload;\n                    break;\n                case SORTED.CHEAP:\n                    state.products = state.products.sort((a, b) => a.price - b.price);\n                    state.currentSort = action.payload;\n                    break;\n                case SORTED.SALE:\n                    state.products = state.products.sort((a, b) => b.discount - a.discount);\n                    state.currentSort = action.payload;\n                    break;\n                default:\n                    state.products = state.products.sort((a, b) => b.likes.length - a.likes.length);\n                    state.currentSort = SORTED.POPULAR;\n            }\n        }\n    },\n    extraReducers: (builder) => {\n        builder.addCase(getAllProductsThunk.fulfilled, (state, action) => {\n            const {total, products, currentUser} = action.payload;\n\n            state.products = products;\n            state.favourites = products.filter(item => isLiked(item.likes, currentUser._id));\n            state.total = total;\n            state.isLoading = false;\n        })\n\n        builder.addCase(getAllProductsThunk.pending, state => {\n            state.error = null;\n            state.isLoading = true;\n        })\n\n        builder.addCase(changeLikeProductThunk.fulfilled, (state, action) => {\n            const {product, liked} = action.payload;\n\n            state.products = state.products.map((cardState) => {\n                return cardState._id === product._id ? product : cardState;\n            })\n\n            if (!liked) {\n                state.favourites.push(product);\n            } else {\n                state.favourites = state.favourites.filter(card => card._id !== product._id);\n            }\n        })\n\n        builder.addCase(changeLikeProductThunk.pending, state => {\n            state.error = null;\n            state.isLoading = true;\n        })\n\n        builder.addMatcher(isError, (state, action) => {\n            state.error = action.payload;\n            state.isLoading = false;\n        })\n    }\n})\n\nexport const {sortedProductsState} = productsSlice.actions;\n\nexport default productsSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}