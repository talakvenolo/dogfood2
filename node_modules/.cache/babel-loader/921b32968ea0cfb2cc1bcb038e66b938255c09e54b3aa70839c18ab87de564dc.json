{"ast":null,"code":"import{createSlice}from\"@reduxjs/toolkit\";import{isError}from\"../../../utils/utilStore\";import{getUserInfoThunk}from\"../../redux-thunk/user-thunk/getUserInfoThunk\";import{registrationThunk}from\"../../redux-thunk/user-thunk/registrationThunk\";import{loginThunk}from\"../../redux-thunk/user-thunk/loginThunk\";import{checkTokenThunk}from\"../../redux-thunk/user-thunk/checkTokenThunk\";var initialState={isAuth:false,userInfo:{},isRegistrationSuccess:false,isLoading:false,error:null};var userSlice=createSlice({name:'user',initialState:initialState,reducers:{logout:function logout(state){state.userInfo={};state.isAuth=false;localStorage.removeItem('jwt');}},extraReducers:function extraReducers(builder){builder.addCase(getUserInfoThunk.fulfilled,function(state,action){state.userInfo=action.payload;state.isLoading=false;});builder.addCase(getUserInfoThunk.pending,function(state){state.error=null;state.isLoading=true;});builder.addCase(registrationThunk.fulfilled,function(state,action){if(Object.keys(action.payload).length>0){state.isRegistrationSuccess=true;state.isLoading=false;}});builder.addCase(registrationThunk.pending,function(state){state.error=null;state.isLoading=true;});builder.addCase(loginThunk.fulfilled,function(state,action){if(Object.keys(action.payload).length>0){state.userInfo=action.payload.data;state.isLoading=false;if(action.payload.token){state.isAuth=true;}}});builder.addCase(loginThunk.pending,function(state){state.error=null;state.isLoading=true;});builder.addCase(checkTokenThunk.fulfilled,function(state,action){if(Object.keys(action.payload).length>0){state.userInfo=action.payload;state.isAuth=true;state.isLoading=false;}});builder.addCase(checkTokenThunk.pending,function(state){state.error=null;state.isLoading=true;});builder.addMatcher(isError,function(state,action){state.error=action.payload;state.isLoading=false;// state.isAuth = false;\n});}});var logout=userSlice.actions.logout;export{logout};export default userSlice.reducer;","map":{"version":3,"names":["createSlice","isError","getUserInfoThunk","registrationThunk","loginThunk","checkTokenThunk","initialState","isAuth","userInfo","isRegistrationSuccess","isLoading","error","userSlice","name","reducers","logout","state","localStorage","removeItem","extraReducers","builder","addCase","fulfilled","action","payload","pending","Object","keys","length","data","token","addMatcher","actions","reducer"],"sources":["C:/Users/User/Desktop/K.V/Education/SberUniversity/dogfood2/src/redux/redux-slice/user/userSlice.js"],"sourcesContent":["import {createSlice} from \"@reduxjs/toolkit\";\nimport {isError} from \"../../../utils/utilStore\";\nimport {getUserInfoThunk} from \"../../redux-thunk/user-thunk/getUserInfoThunk\";\nimport {registrationThunk} from \"../../redux-thunk/user-thunk/registrationThunk\";\nimport {loginThunk} from \"../../redux-thunk/user-thunk/loginThunk\";\nimport {checkTokenThunk} from \"../../redux-thunk/user-thunk/checkTokenThunk\";\n\nconst initialState = {\n    isAuth: false,\n    userInfo: {},\n    isRegistrationSuccess: false,\n    isLoading: false,\n    error: null\n}\nconst userSlice = createSlice({\n    name: 'user',\n    initialState,\n    reducers: {\n        logout: (state) => {\n            state.userInfo = {};\n            state.isAuth = false;\n            localStorage.removeItem('jwt');\n        }\n    },\n    extraReducers: (builder) => {\n        builder.addCase(getUserInfoThunk.fulfilled, (state, action) => {\n            state.userInfo = action.payload;\n            state.isLoading = false;\n        })\n\n        builder.addCase(getUserInfoThunk.pending, state => {\n            state.error = null;\n            state.isLoading = true;\n        })\n\n        builder.addCase(registrationThunk.fulfilled, (state, action) => {\n            if (Object.keys(action.payload).length > 0) {\n                state.isRegistrationSuccess = true;\n                state.isLoading = false;\n            }\n        })\n\n        builder.addCase(registrationThunk.pending, state => {\n            state.error = null;\n            state.isLoading = true;\n        })\n\n        builder.addCase(loginThunk.fulfilled, (state, action) => {\n            if (Object.keys(action.payload).length > 0) {\n                state.userInfo = action.payload.data;\n                state.isLoading = false;\n                if (action.payload.token) {\n                    state.isAuth = true;\n                }\n            }\n        })\n\n        builder.addCase(loginThunk.pending, state => {\n            state.error = null;\n            state.isLoading = true;\n        })\n\n        builder.addCase(checkTokenThunk.fulfilled, (state, action) => {\n            if (Object.keys(action.payload).length > 0) {\n                state.userInfo = action.payload;\n                state.isAuth = true;\n                state.isLoading = false;\n            }\n        })\n\n        builder.addCase(checkTokenThunk.pending, state => {\n            state.error = null;\n            state.isLoading = true;\n        })\n\n        builder.addMatcher(isError, (state, action) => {\n            state.error = action.payload;\n            state.isLoading = false;\n            // state.isAuth = false;\n\n        })\n    }\n})\n\nexport const {logout} = userSlice.actions;\n\nexport default userSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}